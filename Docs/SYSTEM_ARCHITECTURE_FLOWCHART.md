## Self-Improving Wellness Companion Pipeline (Final Architecture)

```
┌───────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                     Self-Improving Wellness Companion Pipeline (Final Architecture)                          │
├───────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                                               │
│  ┌─────────────────┐       ┌─────────────────────┐       ┌─────────────────────────────────┐       ┌───────────┐  │
│  │   Wearable      │       │  Child's Mobile     │       │        Cloud Backend           │       │  Parent's │  │
│  │   Device        │──────►│    Device           │──────►│                                │──────►│  Mobile   │  │
│  │ (TinyLSTM)      │ BLE   │ (Interaction &      │ HTTP/ │ (Self-Improving Intelligence) │ MQTT  │ Device   │  │
│  │                 │       │  Aggregation)       │       │                                │       │ (Avatar)  │  │
│  └─────────┬───────┘       └─────────┬───────────┘       └─────────────┬───────────────────┘       └───┬────┘  │
│            │                         │                                   │                          │       │
│  ┌─────────▼───────┐       ┌─────────▼───────────┐       ┌─────────────▼───────────────────┐       ┌───▼────┐  │
│  │ HR/EDA/Accel    │       │ TinyLSTM            │       │ TimescaleDB/InfluxDB          │       │ TinyLSTM │  │
│  │ Sensors         │──────►│ (Engagement +       │──────►│ (Time-Series: Wellness +      │──────►│ (Alerts) │  │
│  │ + Sleep         │       │  Sleep Classifier)  │       │  Sleep + School Events)       │       │          │  │
│  └─────────┬───────┘       └─────────┬───────────┘       │                              │       │ (enhanced)│  │
│            │               │        │                 │  ┌─────────────────────────┐  │       │ ZenMoon-  │  │
│  ┌─────────▼───────┐       │  ┌──────▼───────┐     │       │  │ BGE-Large Embedding     │  │       │ Avitar    │  │
│  │ TinyLSTM        │       │  │ Aggregator   │     │       │  │ (Vector DB: Weaviate) │  │       │          │  │
│  │ (Smoothing +    │──────►│  │ (Context +    │     │       │  └─────────┬─────────────┘  │       │          │  │
│  │  Anomaly Detect)│       │  │  Sleep/School│     │       │            │                │       │          │  │
│  └─────────┬───────┘       │  │  Events)      │     │       │  ┌─────────▼─────────────┐  │       │          │  │
│            │               │  └──────┬───────┘     │       │  │ Darts (Forecasting:   │  │       │          │  │
│  ┌─────────▼───────┐       │         │             │       │  │  Sleep + Stress)      │  │       │          │  │
│  │ BLE Packet      │       │  ┌──────▼───────┐     │       │  └─────────┬───────────┘  │       │          │  │
│  │ (JSON)          │──────►│  │ HTTP/MQTT    │     │       │            │              │       │          │  │
│  └─────────────────┘       │  └─────────────┘     │       │  ┌─────────▼───────────┐  │       │          │  │
│                            │                    │       │  │ Causal Inference     │  │       │          │  │
│                            │                    │       │  │ (DoWhy/CausalML)     │  │       │          │  │
│                            │                    │       │  └─────────┬───────────┘  │       │          │  │
│                            │                    │       │            │              │       │          │  │
│                            │                    │       │  ┌─────────▼───────────┐  │       │          │  │
│                            │                    │       │  │ Personalization      │  │       │          │  │
│                            │                    │       │  │ (Chronotype Engine)  │  │       │          │  │
│                            │                    │       │  └─────────┬───────────┘  │       │          │  │
│                            │                    │       │            │              │       │          │  │
│                            │                    │       │  ┌─────────▼───────────┐  │       │          │  │
│                            │                    │       │  │ Gemma/Phi-3 + RLHF   │  │──────►│          │  │
│                            │                    │       │  │ (Insight Generator) │  │       │          │  │
│                            │                    │       │  └────────────────────┘  │       │          │  │
│                            │                    │       │                         │       │          │  │
│                            │                    │       │  ┌─────────────────────┐  │       │          │  │
│                            │                    │       │  │ Feedback Loop        │◄───────┘          │  │
│                            │                    │       │  │ (Parent Feedback)    │  │                 │  │
│                            │                    │       │  └─────────────────────┘  │                 │  │
│                            │                    │       │                                │                 │  │
│                            └────────────────────┘       └─────────────────────────────────┘                 │  │
│                                                                                                       │  │
│  ┌───────────────────────────────────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                                       │  │
│  ┌───────────────────────────────────────────────────────────────────────────────────────────────────────────┐  │
│  │                            Parent Feedback Loop (RLHF)                              │  │
│  └───────────────────────────────────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                                       │  │
└───────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```